"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4143],{4143:(M,h,r)=>{r.r(h),r.d(h,{PlaceDetailPageModule:()=>S});var f=r(6814),i=r(95),t=r(7027),m=r(3965),v=r(5861),e=r(6689);let b=(()=>{var a;class s{onBook(){this.ModalCtrl.dismiss({bookingData:{firstName:this.form.value.firstName,lastName:this.form.value.lastName,guestsNumber:this.form.value.guestsNumber,dateFrom:this.form.value.dateFrom,dateTo:this.form.value.dateTo}},"confirm"),console.log(this.form)}onCancel(){this.ModalCtrl.dismiss(null,"cancel")}datesValid(){return this.endDate>this.startDate}constructor(n){this.ModalCtrl=n,this.today=(new Date).toJSON().split("T")[0]}ngOnInit(){console.log(this.place);const n=new Date(this.place.availableFrom),o=new Date(this.place.availableTo);"random"===this.selectedMode&&(this.startDate=new Date(n.getTime()+Math.random()*(o.getTime()-6048e5-n.getTime())).toISOString(),this.endDate=new Date(new Date(this.startDate).getTime()+Math.random()*(new Date(this.startDate).getTime()+5184e5-new Date(this.startDate).getTime())).toISOString()),this.form=new i.cw({firstName:new i.NI(null,{updateOn:"change",validators:[i.kI.required]}),lastName:new i.NI(null,{updateOn:"change",validators:[i.kI.required]}),guestsNumber:new i.NI(null,{updateOn:"change",validators:[i.kI.required,i.kI.min(1)]}),dateFrom:new i.NI(null,{updateOn:"change",validators:[i.kI.required]}),dateTo:new i.NI(null,{updateOn:"change",validators:[i.kI.required]})})}}return(a=s).\u0275fac=function(n){return new(n||a)(e.Y36(t.IN))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-create-bookings"]],inputs:{place:"place",selectedMode:"selectedMode"},decls:40,vars:8,consts:[["color","primary"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding"],[3,"formGroup"],["sizeSm","6","offsetSm","3"],["label","First Name","labelPlacement","floating","fill","outline","type","text","formControlName","firstName"],["label","Last Name","labelPlacement","floating","fill","outline","type","text","formControlName","lastName"],["fill","outline","label","Number of Guests","labelPlacement","floating","formControlName","guestsNumber"],["value","1"],["value","2"],["value","3"],["value","4"],[1,"ion-margin-top"],["formControlName","dateFrom","presentation","date",3,"ngModel","min","max","ngModelChange"],["formControlName","dateTo","presentation","date",3,"ngModel","min","max","ngModelChange"],["expand","block","color","primary","type","submit",3,"disabled","click"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3," Book this place! "),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return o.onCancel()}),e._UZ(6,"ion-icon",3),e.qZA()()()(),e.TgZ(7,"ion-content",4)(8,"form",5)(9,"ion-grid")(10,"ion-row")(11,"ion-col",6),e._UZ(12,"ion-input",7),e.qZA()(),e.TgZ(13,"ion-row")(14,"ion-col",6),e._UZ(15,"ion-input",8),e.qZA()(),e.TgZ(16,"ion-row")(17,"ion-col",6)(18,"ion-select",9)(19,"ion-select-option",10),e._uU(20,"1"),e.qZA(),e.TgZ(21,"ion-select-option",11),e._uU(22,"2"),e.qZA(),e.TgZ(23,"ion-select-option",12),e._uU(24,"3"),e.qZA(),e.TgZ(25,"ion-select-option",13),e._uU(26,"4"),e.qZA()()()(),e.TgZ(27,"ion-row",14)(28,"ion-col",6)(29,"h3"),e._uU(30,"From:"),e.qZA(),e.TgZ(31,"ion-datetime",15),e.NdJ("ngModelChange",function(g){return o.startDate=g}),e.qZA()(),e.TgZ(32,"ion-col",6)(33,"h3"),e._uU(34,"To:"),e.qZA(),e.TgZ(35,"ion-datetime",16),e.NdJ("ngModelChange",function(g){return o.endDate=g}),e.qZA()()(),e.TgZ(36,"ion-row")(37,"ion-col",6)(38,"ion-button",17),e.NdJ("click",function(){return o.onBook()}),e._uU(39,"Book!"),e.qZA()()()()()()),2&n&&(e.xp6(8),e.Q6J("formGroup",o.form),e.xp6(23),e.Q6J("ngModel",o.startDate)("min",o.place.availableFrom.toISOString())("max",o.place.availableTo.toISOString()),e.xp6(4),e.Q6J("ngModel",o.endDate)("min",o.place.availableFrom.toISOString())("max",o.place.availableTo.toISOString()),e.xp6(3),e.Q6J("disabled",!o.form.valid||!o.datesValid()))},dependencies:[i._Y,i.JJ,i.JL,t.YG,t.Sm,t.wI,t.W2,t.x4,t.jY,t.Gu,t.gu,t.pK,t.Nd,t.t9,t.n0,t.wd,t.sr,t.QI,t.j9,i.sg,i.u]}),s})();var Z=r(2883),C=r(8070),T=r(5148);function N(a,s){1&a&&(e.TgZ(0,"div",6),e._UZ(1,"ion-spinner",0),e.qZA())}function D(a,s){if(1&a&&(e.TgZ(0,"ion-grid",3)(1,"ion-row")(2,"ion-col",7),e._UZ(3,"ion-img",8),e.qZA()(),e.TgZ(4,"ion-row")(5,"ion-col",7)(6,"p",9),e._uU(7),e.qZA()()(),e.TgZ(8,"ion-row")(9,"ion-col",7)(10,"div",9)(11,"ion-button",10),e._uU(12,"Book"),e.qZA()()()(),e._UZ(13,"ion-action-sheet",11),e.qZA()),2&a){const l=e.oxw();e.xp6(3),e.Q6J("src",l.place.imageUrl),e.xp6(4),e.Oqu(l.place.description),e.xp6(4),e.Q6J("disabled",!l.isBookable),e.xp6(2),e.Q6J("buttons",l.buttons)}}const P=[{path:"",component:(()=>{var a;class s{onBookPlace(n){var o=this;return(0,v.Z)(function*(){console.log(n);const c=yield o.ModalCtrl.create({component:b,componentProps:{place:o.place,selectedMode:n}});c.present();const{data:g,role:p}=yield c.onWillDismiss();if("confirm"===p){const d=g.bookingData;console.log(d),o.loadingCtrl.create({message:"Creating Your Booking..."}).then(u=>{u.present(),o._BookingsService.addBooking(o.id,o.place.title,o.place.imageUrl,d.firstName,d.lastName,+d.guestsNumber,d.dateFrom,d.dateTo).subscribe(()=>{u.dismiss(),o.NavCtrl.navigateBack("bookings")})})}})()}constructor(n,o,c,g,p,d,u,A,B,I){this.router=n,this.NavCtrl=o,this.route=c,this._PlacesService=g,this.ModalCtrl=p,this.ActionSheetCtrl=d,this._BookingsService=u,this.loadingCtrl=A,this.AuthService=B,this.AlertCtrl=I,this.id="",this.isBookable=!0,this.isLoading=!1,this.buttons=[{text:"Select Date",handler:()=>{this.onBookPlace("select")}},{text:"Random Date",handler:()=>{this.onBookPlace("random")}},{text:"Cancel",role:"cancel"}]}ionViewWillEnter(){}ngOnInit(){this.isLoading=!0,this.id=this.route.snapshot.params.placeId,this.placeSubscription=this._PlacesService.getPlace(this.id).subscribe(n=>{this.place=n,this.isBookable=this.place.userId!==this.AuthService.getUserId(),this.isLoading=!1},n=>{this.presentErrorAlert()})}presentErrorAlert(){var n=this;return(0,v.Z)(function*(){yield(yield n.AlertCtrl.create({header:"An error ocurred",message:"Could not load the place",buttons:[{text:"OK",handler:()=>n.NavCtrl.navigateBack("")}]})).present()})()}ngOnDestroy(){this.placeSubscription&&this.placeSubscription.unsubscribe()}}return(a=s).\u0275fac=function(n){return new(n||a)(e.Y36(m.F0),e.Y36(t.SH),e.Y36(m.gz),e.Y36(Z.E),e.Y36(t.IN),e.Y36(t.BX),e.Y36(C.F),e.Y36(t.HT),e.Y36(T.e),e.Y36(t.Br))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-place-detail"]],decls:9,vars:3,consts:[["color","primary"],["slot","start"],["defaultHref","tabs/discover"],[1,"ion-no-padding"],["class","ion-text-center ion-margin",4,"ngIf"],["class","ion-no-padding",4,"ngIf"],[1,"ion-text-center","ion-margin"],["sizeSm","6","offsetSm","3"],[3,"src"],[1,"ion-text-center"],["color","primary","id","open-action-sheet",2,"color","white",3,"disabled"],["trigger","open-action-sheet","header","Actions",3,"buttons"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-content",3),e.YNc(7,N,2,0,"div",4),e.YNc(8,D,14,4,"ion-grid",5),e.qZA()),2&n&&(e.xp6(5),e.hij(" ",o.isLoading?"":o.place.title," "),e.xp6(2),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("ngIf",!o.isLoading))},dependencies:[f.O5,t.uo,t.oU,t.YG,t.Sm,t.wI,t.W2,t.jY,t.Gu,t.Xz,t.Nd,t.PQ,t.wd,t.sr,t.cs]}),s})()}];let k=(()=>{var a;class s{}return(a=s).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.Bz.forChild(P),m.Bz]}),s})(),S=(()=>{var a;class s{}return(a=s).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.ez,i.u5,t.Pc,k]}),s})()}}]);